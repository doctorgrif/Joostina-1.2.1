# @version $Id: htaccess.txt 5973 2006-12-11 01:26:33Z robs $
# @package Joostina
# @copyright Авторские права (C) 2007 Joostina Team.
# @localized Авторские права (C) 2005 Joom.Ru - Русский дом Joomla!
# @copyright Авторские права (C) 2005 Open Source Matters. Все права защищены.
# @license http://www.gnu.org/copyleft/gpl.html GNU/GPL
# Joomla! - свободное программное обеспечение.
# @translator Sourpuss (Sourpuss@mail.ru)
# @upd doctorgrif (artem.grafov@gmail.com)
##

## Better website experience for IE users
# Force the latest IE version, in various cases when it may fall back to IE7 mode. Use ChromeFrame if
# it's installed for a better experience for the poor IE folk
<IfModule mod_setenvif.c>
<IfModule mod_headers.c>
	BrowserMatch MSIE ie
	Header set X-UA-Compatible "IE=Edge,chrome=1" env=ie
</IfModule>
</IfModule>
<IfModule mod_headers.c>
# Because X-UA-Compatible isn't sent to non-IE (to save header bytes), We need to inform proxies that
# content changes based on UA
	Header append Vary User-Agent
# Cache control is set only if mod_headers is enabled, so that's unncessary to declare
</IfModule>
## Cross-domain AJAX requests
# Serve cross-domain ajax requests, disabled.
#<IfModule mod_headers.c>
#	Header set Access-Control-Allow-Origin "*"
#</IfModule>
## Webfont access
# Allow access from all domains for webfonts. Alternatively you could only whitelist your subdomains
# like "sub.domain.com".
<FilesMatch "\.(ttf|otf|eot|woff|font.css)$">
<IfModule mod_headers.c>
	Header set Access-Control-Allow-Origin "*"
</IfModule>
</FilesMatch>
## Proper MIME type for all files
# Audio
AddType audio/ogg oga ogg
AddType audio/mp4 m4a
# Video
AddType video/ogg ogv
AddType video/mp4 mp4 m4v
AddType video/webm webm
# Proper svg serving
AddType image/svg+xml svg svgz
AddEncoding gzip svgz
# Webfonts
AddType application/vnd.ms-fontobject eot
AddType font/truetype ttf
AddType font/opentype otf
AddType application/x-font-woff woff
# Assorted types
AddType image/x-icon ico
AddType image/webp webp
AddType text/cache-manifest appcache manifest
AddType text/x-component htc
AddType application/x-chrome-extension crx
AddType application/x-xpinstall xpi
AddType application/octet-stream safariextz
AddType text/x-vcard vcf
## Allow concatenation from within specific js and css files e.g.
# Inside of script.combined.js you could have
# <!--#include file="libs/jquery-1.5.0.min.js" --> <!--#include file="plugins/jquery.idletimer.js" -->
# and they would be included into this single file. This is not in use in the boilerplate as it stands.
# You may choose to name your files in this way for this advantage or concatenate and minify them
# manually. Disabled by default.
#<FilesMatch "\.combined\.(js|css)$">
#	Options +Includes
#	SetOutputFilter INCLUDES
#</FilesMatch>
## Gzip compression
<IfModule mod_deflate.c>
# Force deflate for mangled headers
<IfModule mod_setenvif.c>
	<IfModule mod_headers.c>
		SetEnvIfNoCase ^(Accept-EncodXng|X-cept-Encoding|X{15}|~{15}|-{15})$ ^((gzip|deflate)\s,?\s(gzip|deflate)?|X{4,13}|~{4,13}|-{4,13})$ HAVE_Accept-Encoding
		RequestHeader append Accept-Encoding "gzip,deflate" env=HAVE_Accept-Encoding
	</IfModule>
</IfModule>
# HTML, TXT, CSS, JavaScript, JSON, XML, HTC:
<IfModule filter_module>
	FilterDeclare COMPRESS
	FilterProvider COMPRESS DEFLATE resp=Content-Type /text/(html|css|javascript|plain|x(ml|-component))/
	FilterProvider COMPRESS DEFLATE resp=Content-Type /application/(javascript|json|xml|x-javascript)/
	FilterChain COMPRESS
	FilterProtocol COMPRESS change=yes;byteranges=no
</IfModule>
<IfModule !mod_filter.c>
# Legacy versions of Apache
	AddOutputFilterByType DEFLATE text/html text/plain text/css application/json
	AddOutputFilterByType DEFLATE text/javascript application/javascript application/x-javascript 
	AddOutputFilterByType DEFLATE text/xml application/xml text/x-component
</IfModule>
# Webfonts and SVG:
<FilesMatch "\.(ttf|otf|eot|svg)$" >
	SetOutputFilter DEFLATE
</FilesMatch>
</IfModule>
## Expires headers (for better cache control)
# These are pretty far-future expires headers. They assume you control versioning with cachebusting
# query params like <script src="application.js?20100608">. Additionally, consider that outdated proxies
# may miscache. If you don't use filenames to version, lower the CSS and JS to something like
# "access plus 1 week" or so.
<IfModule mod_expires.c>
	ExpiresActive on
# Perhaps better to whitelist expires rules? Perhaps.
	ExpiresDefault "access plus 1 month"
# cache.appcache needs re-requests in FF 3.6
	ExpiresByType text/cache-manifest "access plus 0 seconds"
# Your document html 
	ExpiresByType text/html "access plus 0 seconds"
# Data
	ExpiresByType text/xml "access plus 0 seconds"
	ExpiresByType application/xml "access plus 0 seconds"
	ExpiresByType application/json "access plus 0 seconds"
# RSS feed
	ExpiresByType application/rss+xml "access plus 1 hour"
# Favicon (cannot be renamed)
	ExpiresByType image/x-icon "access plus 1 week" 
# Media: images, video, audio
	ExpiresByType image/gif "access plus 1 month"
	ExpiresByType image/png "access plus 1 month"
	ExpiresByType image/jpg "access plus 1 month"
	ExpiresByType image/jpeg "access plus 1 month"
	ExpiresByType video/ogg "access plus 1 month"
	ExpiresByType audio/ogg "access plus 1 month"
	ExpiresByType video/mp4 "access plus 1 month"
	ExpiresByType video/webm "access plus 1 month"
# HTC files (css3pie)
	ExpiresByType text/x-component "access plus 1 month"
# Webfonts
	ExpiresByType font/truetype "access plus 1 month"
	ExpiresByType font/opentype "access plus 1 month"
	ExpiresByType application/x-font-woff "access plus 1 month"
	ExpiresByType image/svg+xml "access plus 1 month"
	ExpiresByType application/vnd.ms-fontobject "access plus 1 month"
# CSS and JavaScript
	ExpiresByType text/css "access plus 1 year"
	ExpiresByType application/javascript "access plus 1 year"
	ExpiresByType text/javascript "access plus 1 year"
	<IfModule mod_headers.c>
		Header append Cache-Control "public"
	</IfModule>
</IfModule>
## ETag removal
# FileETag None is not enough for every server.
<IfModule mod_headers.c>
	Header unset ETag
</IfModule>
# Since we're sending far-future expires, we don't need ETags for static content.
FileETag None
## Stop screen flicker in IE on CSS rollovers
# The following directives stop screen flicker in IE on CSS rollovers - in combination with the
# "ExpiresByType" rules for images (see above). If needed, un-comment the following rules.
# BrowserMatch "MSIE" brokenvary=1
# BrowserMatch "Mozilla/4.[0-9]{2}" brokenvary=1
# BrowserMatch "Opera" !brokenvary
# SetEnvIf brokenvary 1 force-no-vary
## Cookie setting from iframes
# Allow cookies to be set from iframes (for IE only). If needed, uncomment and specify a path or regex
# in the Location directive
#<IfModule mod_headers.c>
#<Location />
#	Header set P3P "policyref=\"/w3c/p3p.xml\", CP=\"IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT\""
#</Location>
#</IfModule>
## Start rewrite engine
# Turning on the rewrite engine is necessary for the following rules and features.
# FollowSymLinks must be enabled for this to work.
<IfModule mod_rewrite.c>
	Options +FollowSymlinks
	RewriteEngine On
</IfModule>
## Suppress or force the "www." at the beginning of URLs
# The same content should never be available under two different URLs - especially not with and without
# "www." at the beginning, since this can cause SEO problems (duplicate content). That's why you should
# choose one of the alternatives and redirect the other one. By default option 1 (no "www.") is
# activated. Remember: Shorter URLs are sexier. If you rather want to use option 2, just comment out
# all option 1 lines and uncomment option 2. IMPORTANT: NEVER USE BOTH RULES AT THE SAME TIME!
# Option 1: Rewrite "www.domain.com->domain.com" 
#<IfModule mod_rewrite.c>
#	RewriteCond %{HTTPS} !=on
#	RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
#	RewriteRule ^(.*)$ http://%1/$1 [R=301,L]
#</IfModule>
# Option 2: To rewrite "domain.com->www.domain.com" uncomment the following lines. Be aware that the
# following rule might not be a good idea if you use "real" subdomains for certain parts of your website.
#<IfModule mod_rewrite.c>
#	RewriteCond %{HTTPS} !=on
#	RewriteCond %{HTTP_HOST} !^www\..+$ [NC]
#	RewriteCond %{HTTP_HOST} (.+)$ [NC]
#	RewriteRule ^(.*)$ http://www.%1/$1 [R=301,L]
#</IfModule>
## Built-in filename-based cache busting
# If you're not using the build script to manage your filename version revving, you might want to
# consider enabling this, which will route requests for /css/style.20110203.css to /css/style.css
# To understand why this is important and a better idea than all.css?v1231. Uncomment to enable.
<IfModule mod_rewrite.c>
	RewriteCond %{REQUEST_FILENAME} !-f
	RewriteCond %{REQUEST_FILENAME} !-d
	RewriteRule ^(.+)\.(\d+)\.(js|css|png|jpg|gif)$ $1.$3 [L]
</IfModule>
## Prevent SSL cert warnings
# Rewrite secure requests properly to prevent SSL cert warnings, e.g. prevent 
# https://www.domain.com when your cert only allows https://secure.domain.com
# Uncomment the following lines to use this feature.
#<IfModule mod_rewrite.c>
#	RewriteCond %{SERVER_PORT} !^443
#	RewriteRule (.*) https://example-domain-please-change-me.com/$1 [R=301,L]
#</IfModule>
## Prevent 404 errors for non-existing redirected folders
# without -MultiViews, Apache will give a 404 for a rewrite if a folder of the same name does not exist 
# e.g. /blog/hello
Options -MultiViews 
## Custom 404 page
# You can add custom pages to handle 500 or 403 pretty easily, if you like.
# ErrorDocument 404 /404.html
## Encoding
# Use WINDOWS-1251 encoding for anything served text/plain or text/html
AddDefaultCharset WINDOWS-1251
# Force UTF-8 for a number of file formats
AddCharset utf-8 .css .js .json
## A little more security
# Do we want to advertise the exact version number of Apache we're running? Probably not.
# This can only be enabled if used in httpd.conf - It will not work in .htaccess
# ServerTokens Prod "-Indexes" will have Apache block users from browsing folders without a default
# document. Usually you should leave this activated, because you shouldn't allow everybody to surf
# through every folder on your server (which includes rather private places like CMS system folders).
Options -Indexes
# Block access to "hidden" directories whose names begin with a period. This includes directories
# used by version control systems such as Subversion or Git.
<IfModule mod_rewrite.c>
	RewriteRule "(^|/)\." - [F]
</IfModule>
# If your server is not already configured as such, the following directive should be uncommented
# in order to set PHP's register_globals option to OFF. This closes a major security hole that is
# abused by most XSS (cross-site scripting) attacks.
# For more information: http://php.net/register_globals
# IF REGISTER_GLOBALS DIRECTIVE CAUSES 500 INTERNAL SERVER ERRORS:
# Your server does not allow PHP directives to be set via .htaccess. In that case you must make
# this change in your php.ini file instead. If you are using a commercial web host, contact the
# administrators for assistance in doing this. Not all servers allow local php.ini files, and they
# should include all PHP configurations (not just this one), or you will effectively reset
# everything to PHP defaults. Consult www.php.net for more detailed information about setting
# PHP directives.
# php_flag register_globals Off
php_value magic_quotes_gpc 1
# Rename session cookie to something else, than PHPSESSID
# php_value session.name sid
# Do not show you are using php
# php_flag expose_php Off
# Level of log detail - log all errors
# php_value error_reporting -1
# Write errors to log file
# php_flag log_errors On
# Do not display errors in browser (production - Off, development - On)
# php_flag display_errors Off
# Do not display startup errors (production - Off, development - On)
# php_flag display_startup_errors Off
# Format errors in plain text
# php_flag html_errors Off
# Show multiple occurrence of error
# php_flag ignore_repeated_errors Off
# Show same errors from different sources
# php_flag ignore_repeated_source Off
# Size limit for error messages
# php_value log_errors_max_len 1024
# Don't precede error with string (doesn't accept empty string, use whitespace if you need)
# php_value error_prepend_string " "
# Don't prepend to error (doesn't accept empty string, use whitespace if you need)
# php_value error_append_string " "
# Increase cookie security
<IfModule php5_module>
	php_value session.cookie_httponly true
</IfModule>
# RewriteBase /
## Стандартный SEF
# Используйте эту секцию ТОЛЬКО для работы встроенного SEF Joostina.
# ВСЕ (RewriteCond) строки в этой секции необходимы только если на вашем сервере имеются каталоги
# с названиями content/ или component/. Если такие каталоги отсутствуют, то закомментируйте эти строки.
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
# RewriteCond %{REQUEST_URI} ^(/component/option,com) [NC,OR] # опционально #
RewriteCond %{REQUEST_URI} (/|\.htm|\.php|\.html|/[^.]*)$ [NC]
RewriteRule ^(view/|content/|component/) index.php
## SEF сторонних разработчиков
# Используйте этот раздел, если используете SEF-расширения sh404SEF, JPromoter, Atrio JoomSEF и т.д.
# RewriteCond %{REQUEST_URI} ^(/component/option,com) [NC,OR] # опционально #
# RewriteCond %{REQUEST_URI} (/|\.htm|\.php|\.html|/[^.]*)$ [NC]
# RewriteCond %{REQUEST_FILENAME} !-f
# RewriteCond %{REQUEST_FILENAME} !-d
# RewriteRule (.*) index.php